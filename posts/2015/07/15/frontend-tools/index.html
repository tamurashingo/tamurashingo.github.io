<!DOCTYPE html>
<html lang="ja-jp">
    <head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>
				フロントエンドの開発に使うツール類 &middot; Web技術と親しむ
		</title>

		
  		<link rel="stylesheet" href="/css/style.css">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">
		
		<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
		<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

		
		<link href="" rel="alternate" type="application/rss+xml" title="Web技術と親しむ" />
	</head>

    <body>
        		<nav class="nav">
			<div class="nav-container">
				<a href="/">
					<h2 class="nav-title">Web技術と親しむ</h2>
				</a>
				<ul>
    <li><a href="/about">About</a></li>
    <li><a href="/">Posts</a></li>
</ul>
			</div>
		</nav>

        

<main>
	<div class="post">
		<div class="post-info">
    <span>Written by</span>
        
        <br>
        <span>on&nbsp;</span><time datetime="2015-07-15 07:04:09 &#43;0000 UTC">July 15, 2015</time>
</div>
		<h1 class="post-title">フロントエンドの開発に使うツール類</h1>
<div class="post-line"></div>

		


		

<p>tamuraです。</p>

<p>先日、社内勉強会で「なぜフロントエンドの開発にビルドが必要なのか?」という質問が出てうまく回答できなかったので、フロントエンド開発でなにを行っているか少しまとめてみました。</p>

<p>まあ一言で言うと開発効率向上のためです。</p>

<!-- more -->

<h2 id="雛形作成">雛形作成</h2>

<p>最近はフロントエンド側をAngularJSで作ることが多いのでYeomanを使って雛形を作っています。 その際に<code>generator-angular</code>でアプリケーションの雛形を作ります。</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ mkdir sample
$ <span class="nb">cd</span> sample
$ yo angular sample</code></pre></div>
<h2 id="フロントエンド用のライブラリのダウンロード">フロントエンド用のライブラリのダウンロード</h2>

<p>Bowerはフロントエンド用のパッケージマネージャです。
例えば<code>lodash</code>というライブラリを使いたい場合、 以前の私であればサイトからリリースファイルをダウンロードしてローカルに配置してということをやっていましたが、 Bowerを使うと</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ bower install lodash --save</code></pre></div>
<p>だけで済みます。</p>

<p>これで<code>bower_components</code>というディレクトリにダウンロードされるので、それを読み込むだけです。</p>

<h2 id="bowerでダウンロードしたファイルの自動反映">Bowerでダウンロードしたファイルの自動反映</h2>

<p>前述のBower等でインストールしたファイルは<code>bower_components</code>ディレクトリに格納されます。 これを手で<code>index.html</code>に反映させても良いのですが、<code>wiredep</code>を使うことで自動で<code>index.html</code>に反映してくれます。</p>

<p>Gruntfile.js</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript">  <span class="nx">wiredep</span> <span class="p">{</span>
    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">cwd</span><span class="o">:</span> <span class="s1">&#39;&lt;%= yeoman.app %&gt;&#39;</span>
    <span class="p">},</span>
    <span class="nx">app</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&lt;%= yeoman.app %&gt;/index.html&#39;</span><span class="p">],</span>
      <span class="nx">ignorePath</span><span class="o">:</span> <span class="sr">/\.\.\//</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div>
<p>index.html</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>  
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>  
  <span class="c">&lt;!-- bower:css --&gt;</span>
  <span class="c">&lt;!-- endbower --&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>  
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>  
  <span class="c">&lt;!-- bower:js --&gt;</span>
  <span class="c">&lt;!-- endbower --&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>  
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>  </code></pre></div>
<p>この状態で</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ grunt wiredep</code></pre></div>
<p>と打つことで<code>index.html</code>にBowerでインストールしたライブラリが反映されます。</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>  
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>  
  <span class="c">&lt;!-- bower:css --&gt;</span>
  <span class="c">&lt;!-- endbower --&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>  
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>  
  <span class="c">&lt;!-- bower:js --&gt;</span>
  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;bower_components/lodash/lodash.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="c">&lt;!-- endbower --&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>  
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>  </code></pre></div>
<p>この例はJavaScriptだけですが、CSSがある場合はCSSの読み込みも反映されます。</p>

<h2 id="自作のjs-cssの自動反映">自作のJS/CSSの自動反映</h2>

<p>JSやCSSが増える都度手作業でファイルを<code>index.html</code>等に追加するのは面倒です。
<code>grunt-asset-injector</code>を使うことで<code>wiredep</code>のようにファイルを自動で追加してくれます。</p>

<p>Gruntfile.js</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript">  <span class="nx">injector</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
    <span class="p">},</span>
    <span class="nx">scripts</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">transform</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">filePath</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">filePath</span> <span class="o">=</span> <span class="nx">filePath</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;/app\/app/&#39;</span><span class="p">,</span> <span class="s1">&#39;app/&#39;</span><span class="p">);</span>
          <span class="nx">filePath</span> <span class="o">=</span> <span class="nx">filePath</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;/app\/components/&#39;</span><span class="p">,</span> <span class="s1">&#39;components/&#39;</span><span class="p">);</span>
          <span class="nx">filePath</span> <span class="o">=</span> <span class="nx">filePath</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;/.tmp/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
          <span class="k">return</span> <span class="s1">&#39;&lt;script src=&#34;&#39;</span> <span class="o">+</span> <span class="nx">filePath</span> <span class="o">+</span> <span class="s1">&#39;&#34;&gt;&lt;/script&gt;&#39;</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">starttag</span><span class="o">:</span> <span class="s1">&#39;&lt;!-- injector:js --&gt;&#39;</span><span class="p">,</span>
        <span class="nx">endtag</span><span class="o">:</span> <span class="s1">&#39;&lt;!-- endinjector --&gt;&#39;</span>
      <span class="p">},</span>
      <span class="nx">files</span><span class="o">:</span> <span class="p">{</span>
        <span class="s1">&#39;&lt;%= yeoman.app %&gt;/index.html&#39;</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">[</span><span class="s1">&#39;{.tmp,&lt;%= yeoman.app %&gt;/{app,components}/{,*/}*.js&#39;</span><span class="p">,</span>
           <span class="s1">&#39;!{.tmp,&lt;%= yeoman.app %&gt;/{app,components}/{,*/}*.spec.js&#39;</span><span class="p">,</span>
           <span class="s1">&#39;!{.tmp,&lt;%= yeoman.app %&gt;/{app,components}/{,*/}*.mock.js&#39;</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">css</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">transform</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">filePath</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">filePath</span> <span class="o">=</span> <span class="nx">filePath</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;/app\/app/&#39;</span><span class="p">,</span> <span class="s1">&#39;app/&#39;</span><span class="p">);</span>
          <span class="nx">filePath</span> <span class="o">=</span> <span class="nx">filePath</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;/app\/components/&#39;</span><span class="p">,</span> <span class="s1">&#39;components/&#39;</span><span class="p">);</span>
          <span class="nx">filePath</span> <span class="o">=</span> <span class="nx">filePath</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;/.tmp/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
          <span class="k">return</span> <span class="s1">&#39;&lt;link rel=&#34;stylesheet&#34; href=&#34;&#39;</span> <span class="o">+</span> <span class="nx">filePath</span> <span class="o">+</span> <span class="s1">&#39;&#34;&gt;&#39;</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">starttag</span><span class="o">:</span> <span class="s1">&#39;&lt;!-- injector:css --&gt;&#39;</span><span class="p">,</span>
        <span class="nx">endtag</span><span class="o">:</span> <span class="s1">&#39;&lt;!-- endinjector --&gt;&#39;</span>
      <span class="p">},</span>
      <span class="nx">files</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s1">&#39;&lt;%= yeoman.app %&gt;/index.html&#39;</span><span class="o">:</span> <span class="p">[</span>
          <span class="s1">&#39;{.tmp,&lt;%= yeoman.app %&gt;}/{app,components}/{,*/}*.css&#39;</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div>
<p>index.html</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>  
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>  
  <span class="c">&lt;!-- bower:css --&gt;</span>
  <span class="c">&lt;!-- endbower --&gt;</span>
  <span class="c">&lt;!-- injector:css --&gt;</span>
  <span class="c">&lt;!-- endinjector --&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>  
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>  
  <span class="c">&lt;!-- bower:js --&gt;</span>
  <span class="c">&lt;!-- endbower --&gt;</span>
  <span class="c">&lt;!-- injector:js --&gt;</span>
  <span class="c">&lt;!-- endinjector --&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>  
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>  </code></pre></div>
<p>この状態で</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ grunt injector</code></pre></div>
<p>と打つことで<code>index.html</code>に対して、追加したJS/CSSファイルが反映されます。</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>  
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>  
  <span class="c">&lt;!-- bower:css --&gt;</span>
  <span class="c">&lt;!-- endbower --&gt;</span>
  <span class="c">&lt;!-- injector:css --&gt;</span>
  <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;app/app.css&#34;</span><span class="p">&gt;</span>
  <span class="c">&lt;!-- endinjector --&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>  
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>  
  <span class="c">&lt;!-- bower:js --&gt;</span>
  <span class="c">&lt;!-- endbower --&gt;</span>
  <span class="c">&lt;!-- injector:js --&gt;</span>
  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;app/app.js&#34;</span><span class="p">&gt;</span><span class="err">
</span><span class="err">  &lt;!-- endinjector --&gt;
</span><span class="err">&lt;/body&gt;  
</span><span class="err">&lt;/html&gt;  </span></code></pre></div>
<h2 id="複数のファイルの結合">複数のファイルの結合</h2>

<p>AngularJSを使ったアプリはJSファイルが多くなりがちです。
ファイル数が増えるとその分サーバへのアクセスが増え、結果的に遅くなります。 開発中はそれでも問題はないのですが、本番環境で動かす際に問題となります。</p>

<p>そのため、<code>grunt-usemin</code>で複数のファイルを結合します。</p>

<p>Gruntfile.js</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript">  <span class="nx">useminPrepare</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">html</span><span class="o">:</span> <span class="s1">&#39;&lt;%= yeoman.app %&gt;/index.html&#39;</span><span class="p">,</span>
    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;&lt;%= yeoman.dist %&gt;&#39;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">usemin</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">html</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&lt;%= yeoman.dist %&gt;/{,*/}*html&#39;</span><span class="p">],</span>
    <span class="nx">css</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&lt;%= yeoman.dist %&gt;/{,*/}*.css&#39;</span><span class="p">],</span>
    <span class="nx">js</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&lt;%= yeoman.dist %&gt;/{,*}*.js&#39;</span><span class="p">],</span>
    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">assetsDirs</span><span class="o">:</span> <span class="p">[</span>
        <span class="s1">&#39;&lt;%= yeoman.dist %&gt;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;&lt;%= yeoman.dist %&gt;/assets/images&#39;</span><span class="p">,</span>
      <span class="p">],</span>
      <span class="nx">patterns</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">js</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">[</span><span class="sr">/(assets\/images\/.*?\.(?:gif|jpeg|jpg|png|webp|svg))/gm</span><span class="p">,</span> <span class="s1">&#39;Update the JS to reference our revved images&#39;</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="nx">css</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">[</span><span class="sr">/()/g</span><span class="p">,</span> <span class="s1">&#39;Replacing reference to FontFile&#39;</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>  
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- build:css assets/css/vendor.css --&gt;</span>
      <span class="c">&lt;!-- bower:css --&gt;</span>
      <span class="c">&lt;!-- endbower --&gt;</span>
    <span class="c">&lt;!-- endbuild --&gt;</span>

    <span class="c">&lt;!-- build:css assets/css/app.css --&gt;</span>
      <span class="c">&lt;!-- injector:css --&gt;</span>
      <span class="c">&lt;!-- endinjector --&gt;</span>
    <span class="c">&lt;!-- endbuild --&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
  <span class="c">&lt;!-- build:js assets/script/vendor.js --&gt;</span>
    <span class="c">&lt;!-- bower:js --&gt;</span>
    <span class="c">&lt;!-- endbower --&gt;</span>
  <span class="c">&lt;!-- endbuild --&gt;</span>

  <span class="c">&lt;!-- build:js assets/script/app.js --&gt;</span>
    <span class="c">&lt;!-- injector:js --&gt;</span>
    <span class="c">&lt;!-- endinjector --&gt;</span>
  <span class="c">&lt;!-- endbuild --&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>  </code></pre></div>
<p>この状態からビルドを行うことで、<code>index.html</code>が更新されます。</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>  
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;assets/css/vendor.css&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;assets/css/app.css&#34;</span><span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;assets/script/vendor.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;assets/script/app.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>  </code></pre></div>
<h2 id="その他">その他</h2>

<p><code>generator-angular</code>で色々なタスクが登録されています。 <code>index.html</code>が変更されるため主に意識しているのは上記のタスクですが、 <code>Gruntfile.js</code>に色々かいてあるので読んでみてください。</p>

<p>ちょっと紹介しきれませんでした。</p>


		
	</div>

	<div class="pagination">
		<a href="/posts/2015/06/13/dropwizard-database-3/" class="left arrow">&#8592;</a>
		<a href="/posts/2015/08/26/golang-mysql/" class="right arrow">&#8594;</a>

		<a href="#" class="top">Top</a>
	</div>
</main>


        		<footer>
			<span>
			&copy; <time datetime="2019-04-16 22:08:13.864516 &#43;0900 JST m=&#43;0.431207961">2019</time> tamura shingo. Made with <a href='https://gohugo.io'>Hugo</a> using the <a href='https://github.com/EmielH/tale-hugo/'>Tale</a> theme.
			</span>
		</footer>

    </body>
</html>
