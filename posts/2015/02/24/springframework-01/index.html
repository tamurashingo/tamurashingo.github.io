<!DOCTYPE html>
<html lang="ja-jp">
    <head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>
				Spring Frameworkを使ってみるpart1 &middot; Web技術と親しむ
		</title>

		
  		<link rel="stylesheet" href="/css/style.css">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">
		
		<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
		<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

		
		<link href="" rel="alternate" type="application/rss+xml" title="Web技術と親しむ" />
	</head>

    <body>
        		<nav class="nav">
			<div class="nav-container">
				<a href="/">
					<h2 class="nav-title">Web技術と親しむ</h2>
				</a>
				<ul>
    <li><a href="/about">About</a></li>
    <li><a href="/">Posts</a></li>
</ul>
			</div>
		</nav>

        

<main>
	<div class="post">
		<div class="post-info">
    <span>Written by</span>
        
        <br>
        <span>on&nbsp;</span><time datetime="2015-02-24 01:08:33 &#43;0000 UTC">February 24, 2015</time>
</div>
		<h1 class="post-title">Spring Frameworkを使ってみるpart1</h1>
<div class="post-line"></div>

		


		

<p>tamuraです。
Spring Frameworkを使ったことがありませんが、始め方について簡単にまとめてみました。
使用するバージョンは4系です。</p>

<!-- more -->

<h2 id="目標">目標</h2>

<ul>
<li>ブラウザでhello worldを表示する。

<ul>
<li><a href="http://localhost:8080/greeting">http://localhost:8080/greeting</a> に接続すると &ldquo;Hello, World!&rdquo; というメッセージが表示される。</li>
<li><a href="http://localhost:8080/greeting?name=User">http://localhost:8080/greeting?name=User</a> に接続すると &ldquo;Hello, User!&rdquo; というメッセージが表示される。</li>
</ul></li>
</ul>

<p><a href="https://spring.io/guides/gs/serving-web-content/">Serving Web Content with Spring MVC</a>
ここの内容をやっていきます。 Gradleをちゃんと使ったことがないので、ちゃんと使ったことのあるMavenでやっていきます。</p>

<h2 id="jdkインストール">JDKインストール</h2>

<p>Java8をインストールします。</p>

<p><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a>
ここからJava SE 8uxxを落としてインストールします。</p>

<p>Windows</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh"><span class="nb">set</span> <span class="nv">JAVA_HOME</span><span class="o">=</span>&lt;インストールディレクトリ&gt;  
<span class="nb">set</span> <span class="nv">PATH</span><span class="o">=</span>%JAVA_HOME%<span class="se">\b</span>in<span class="p">;</span>%PATH%  </code></pre></div>
<p>Mac/Unix(sh系)</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh"><span class="nb">export</span> <span class="nv">JAVA_HOME</span><span class="o">=</span>&lt;インストールディレクトリ&gt;  
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="si">${</span><span class="nv">JAVA_HOME</span><span class="si">}</span>/bin:<span class="nv">$PATH</span></code></pre></div>
<h2 id="mavenインストール">Mavenインストール</h2>

<p><a href="http://maven.apache.org/download.cgi">http://maven.apache.org/download.cgi</a>
ここからMavenを落とします。3以上であればどれでも大丈夫です。 適当なディレクトリに展開して、こちらもパスの設定を行います。</p>

<p>Windows</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh"><span class="nb">set</span> <span class="nv">M2_HOME</span><span class="o">=</span>&lt;展開先ディレクトリ&gt;  
<span class="nb">set</span> <span class="nv">PATH</span><span class="o">=</span>%M2_HOME%<span class="se">\b</span>in<span class="p">;</span>%PATH%  </code></pre></div>
<p>Mac/Unix(sh系)</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh"><span class="nb">export</span> <span class="nv">M2_HOME</span><span class="o">=</span>&lt;展開先ディレクトリ&gt;
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="si">${</span><span class="nv">M2_HOME</span><span class="si">}</span>/bin:<span class="nv">$PATH</span></code></pre></div>
<h2 id="プロジェクトの作成">プロジェクトの作成</h2>

<p>プロジェクトディレクトリを作成してそこに<code>pom.xml</code>を置きます。</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">mkdir spring_sample
<span class="nb">cd</span> sprint_sample
vi pom.xml</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
         <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
         <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>gs-serving-web-content<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>0.1.0<span class="nt">&lt;/version&gt;</span>

  <span class="nt">&lt;parent&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.2.1.RELEASE<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;/parent&gt;</span>

  <span class="nt">&lt;dependencies&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-thymeleaf<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
  <span class="nt">&lt;/dependencies&gt;</span>

  <span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;plugins&gt;</span>
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
  <span class="nt">&lt;/build&gt;</span>

  <span class="nt">&lt;repositories&gt;</span>
    <span class="nt">&lt;repository&gt;</span>
      <span class="nt">&lt;id&gt;</span>spring-milestone<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;url&gt;</span>https://repo.spring.io/libs-release<span class="nt">&lt;/url&gt;</span>
    <span class="nt">&lt;/repository&gt;</span>
  <span class="nt">&lt;/repositories&gt;</span>

  <span class="nt">&lt;pluginRepositories&gt;</span>
    <span class="nt">&lt;pluginRepository&gt;</span>
      <span class="nt">&lt;id&gt;</span>spring-milestone<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;url&gt;</span>https://repo.spring.io/libs-release<span class="nt">&lt;/url&gt;</span>
    <span class="nt">&lt;/pluginRepository&gt;</span>
  <span class="nt">&lt;/pluginRepositories&gt;</span>
<span class="nt">&lt;/project&gt;</span></code></pre></div>
<h2 id="コントローラの作成">コントローラの作成</h2>

<p>SpringではHTTPリクエストはコントローラが受け付けます。
<code>@Controller</code>アノテーションを付与すれば簡単に作成できます。 これから作成する<code>GreetingController</code>では<code>/greeting</code>にGETリクエストがあった際に、<code>greeting</code>というビューの名前を返します。</p>

<p>ビューはHTMLを生成する役割を持ちます。</p>

<p>src/main/java/hello/GreetingController.java</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">hello</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.ui.Model</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestParam</span><span class="o">;</span>

<span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GreetingController</span> <span class="o">{</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&#34;/greeting&#34;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">greeting</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">false</span><span class="o">,</span> <span class="n">defaultValue</span><span class="o">=</span><span class="s">&#34;World&#34;</span><span class="o">)</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="n">name</span><span class="o">);</span>
        <span class="k">return</span> <span class="s">&#34;greeting&#34;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>
<h3 id="アノテーション">アノテーション</h3>

<ul>
<li><p><code>@RequestMapping</code></p>

<ul>
<li><code>/greeting</code>へのリクエストと<code>greeting()</code>メソッドを紐付ける</li>
</ul></li>

<li><p><code>@RequestParam</code></p>

<ul>
<li><code>name</code>パラメタの値をを引数<code>name</code>にセットする</li>
<li><code>name</code>パラメタは必須ではない (<code>required=false</code>)</li>
<li>デフォルト値は<code>World</code> (<code>defaultValue=&quot;World&quot;</code>)</li>
</ul></li>
</ul>

<h3 id="実装">実装</h3>

<p><code>Model</code>オブジェクトに<code>&quot;name&quot;</code>というキーワードで<code>name</code>を登録する。
ビューの名前を<code>&quot;greeting&quot;</code>で返す。</p>

<h2 id="ビューの作成">ビューの作成</h2>

<p>つづいてビューを作ります。 今回はThymeleafを使ってサーバ側でレンダリングしたHTMLをブラウザへ返します。</p>

<p>vi src/main/resources/templates/greeting.html</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!doctype html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">xmlns:th</span><span class="o">=</span><span class="s">&#34;http://www.thymeleaf.org&#34;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Greeting Started: Serving Web Content<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;Content-Type&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;text/html; charset=UTF-8&#34;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&#34;&#39;Hello, &#39; + ${name} + &#39;!&#39;&#34;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></code></pre></div>
<h2 id="実行可能にする">実行可能にする</h2>

<p>WARファイルを生成してTomcat等にデプロイすれば動くのですが、ここでは実行可能なJarファイルを作ってみます。</p>

<p>src/main/java/hello/Application.java</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">hello</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.ComponentScan</span><span class="o">;</span>

<span class="nd">@ComponentScan</span>
<span class="nd">@EnableAutoConfiguration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Application</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">...</span><span class="na">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">Application</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>
<h3 id="アノテーション-1">アノテーション</h3>

<ul>
<li><p><code>@ComponentScan</code></p>

<ul>
<li><code>hello</code>パッケージとその子パッケージを調べ、<code>@Component</code>アノテーションがついたクラスをSpringに伝える</li>
<li><code>@Controller</code>がついている<code>GreetingController</code>が対象</li>
<li><code>@Controller</code>は<code>@Component</code>の一種</li>
</ul></li>

<li><p><code>@EnableAutoConfiguration</code></p>

<ul>
<li>ベースにあわせた振る舞いを行う</li>
<li><code>web.xml</code>を使った設定は不要</li>
</ul></li>
</ul>

<h2 id="実行">実行</h2>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">mvn spring-boot:run</code></pre></div>
<p>で実行します。ブラウザを開いて <a href="http://localhost:8080/greeting">http://localhost:8080/greeting</a> にアクセスします。</p>


		
	</div>

	<div class="pagination">
		<a href="/posts/2015/02/21/ime-in-ghost/" class="left arrow">&#8592;</a>
		<a href="/posts/2015/02/24/springframework-02/" class="right arrow">&#8594;</a>

		<a href="#" class="top">Top</a>
	</div>
</main>


        		<footer>
			<span>
			&copy; <time datetime="2019-04-16 22:08:13.873983 &#43;0900 JST m=&#43;0.440675613">2019</time> tamura shingo. Made with <a href='https://gohugo.io'>Hugo</a> using the <a href='https://github.com/EmielH/tale-hugo/'>Tale</a> theme.
			</span>
		</footer>

    </body>
</html>
